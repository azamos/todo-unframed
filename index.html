<!DOCTYPE html>
<html lang="en">
<head>
    <script type="text/javascript" src="./index.js"></script>
    <link rel="stylesheet" href="./index.css"/>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div style="display: flex;flex-direction: column;justify-content: center;align-items: center;text-align: center;">
        <h1>task manager</h1>
        <div id="btn"
        style="box-shadow: 2px 2px 20px 2px dodgerblue;
        border: 2px solid orange;
        width: 10vw;height: 10vh;
        display: flex;flex-direction: column;justify-content: center;align-items: center;">
            <h2>Add a task</h2>
        </div>
    </div>
    TASKS:
    <div id="tasks" class="spaced" style="display: flex;flex-direction: row;flex-wrap: wrap;"></div>
    <!--Template code starts here-->
    <div class="template hidden flex column centrelized shield spaced">
        <textarea placeholder="Describe task"></textarea>
        <div class="flex row">
            <div class="submitTask" 
            style="box-shadow: 1px 1px 2px 1px dodgerblue;
            border: 1px solid dodgerblue;
            width: 3vw;height: 3vh;
            display: flex;flex-direction: column;justify-content: center;align-items: center;">
                <h2>+</h2>
            </div>
            <div  class="deleteTask"
            style="box-shadow: 1px 1px 2px 1px red;
            border: 1px solid red;
            width: 3vw;height: 3vh;
            display: flex;flex-direction: column;justify-content: center;align-items: center;">
                <h2>-</h2>
            </div>
        </div>
    </div>
    <!--Template code ENDS here-->
    <script>
        
        var counter = 1;//For purpose of id generating for each task

        var firstTask = document.getElementsByClassName("template")[0];/*
        *Get the html fragment of the template, to be later deep cloned with the Node.clone method
        *whenever new tasks are created
        */
        document.getElementById("btn").addEventListener("click",e=>{
            const clonedNode = firstTask.cloneNode(true);
            clonedNode.classList.remove("hidden");//Since the template is hidden, this new "instance" must revert back to visible
            const id = `task${counter++}`;//To avoid id duplication, we used global variable counter
            clonedNode.setAttribute("id",id);
            const title = document.createElement("div");
            title.innerHTML=`<h3>${id}</h3>;`
            title.classList.add("top");
            clonedNode.appendChild(title);//TODO: find way to prepend instead of append
            const deleteBtn = clonedNode.childNodes[3].childNodes[3];
            deleteBtn.addEventListener("click",()=>removeTask(id))
            document.getElementById("tasks").appendChild(clonedNode);
            clonedNode.insertBefore(title,clonedNode.childNodes[1]);
        });

    </script>
</body>
</html>